<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/base}">
  <main layout:fragment="content" class="container py-5">
    <!-- Schedule Selector -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="section">Mis horarios</h2>
      <div th:if="${not schedules?.empty}">
        <form id="scheduleForm" th:action="@{/}" method="get">
          <select class="form-select" id="scheduleSelector" style="width: 250px;"
                  name="id" onchange="this.form.submit()">
            <option value="" selected disabled>Selecciona un horario</option>
            <option th:each="schedule : ${schedules}" 
                    th:value="${schedule.id}"
                    th:text="${schedule.description}"
                    th:selected="${selectedSchedule != null and selectedSchedule.id == schedule.id}">
            </option>
          </select>
        </form>
      </div>
    </div>
    <!-- Empty Schedules Message -->
    <div th:if="${schedules?.empty}" class="alert alert-info">
      No tienes horarios registrados.
    </div>
    <!-- Selected Schedule Content -->
    <div th:replace="~{fragments/schedule :: schedule(${selectedSchedule})}" 
         th:if="${selectedSchedule != null}">
    </div>
    <!-- Error Message (if not shown in fragment) -->
    <div th:if="${error != null and !#strings.isEmpty(error)}" class="alert alert-danger mt-3">
      <span th:text="${error}"></span>
    </div>
  </main>
</html>
